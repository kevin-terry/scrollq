const t=new Map;let e="down",r=window.scrollY,s=!1;export const initScrollQ=(o={})=>{const a=o.threshold??.5,n=o.rootMargin??"0px 0px -10% 0px",i=o.reverse??!1,c=o.selector??"[data-q]";s||(window.addEventListener("scroll",()=>{const t=window.scrollY;e=t>r?"down":"up",r=t},{passive:!0}),s=!0);const d=new Map;return document.querySelectorAll(c).forEach(r=>{const s=r.getAttribute("data-q")||"",o=r.getAttribute("data-q-threshold"),c=null!==o&&""!==o?Math.min(Math.max(parseFloat(o)||0,0),1):a,l=r.getAttribute("data-q-reverse"),u=r.hasAttribute("data-q-reverse")?"false"!==l:i;let q=n;const p=r.getAttribute("data-q-offset");if(p){q=`0px 0px ${p.match(/[a-z%]+$/i)?p:`${p}px`} 0px`}const b=r.getAttribute("data-q-from");b&&(s.includes("up")||s.includes("down")?r.style.setProperty("--q-from-y",b):(s.includes("left")||s.includes("right"))&&r.style.setProperty("--q-from-x",b));const g=r.getAttribute("data-q-duration"),h=r.getAttribute("data-q-easing"),v=r.getAttribute("data-q-delay");g&&r.style.setProperty("--q-duration",g),h&&r.style.setProperty("--q-easing",h),v&&r.style.setProperty("--q-delay",`${v}ms`);const y=((r,s,o)=>{const a=`${r}-${s}-${o}`;if(d.has(a))return d.get(a);const n=new IntersectionObserver(t=>{t.forEach(t=>{const s=t.target,a=s.classList.contains("q-active"),i=t.isIntersecting&&t.intersectionRatio>=r,c=!s.hasAttribute("data-q-observed");i&&!a?!c&&o&&"down"!==e||(s.classList.add("q-active"),s.setAttribute("data-q-observed","true"),o||n.unobserve(s)):!i&&a&&o&&"up"===e?s.classList.remove("q-active"):c&&(t.boundingClientRect.bottom<0&&s.classList.add("q-active"),s.setAttribute("data-q-observed","true"))})},{threshold:r,rootMargin:s});return d.set(a,n),t.set(a,n),n})(c,q,u);y.observe(r)}),()=>{d.forEach(t=>t.disconnect()),d.clear()}};export const destroyScrollQ=()=>{t.forEach(t=>t.disconnect()),t.clear()};