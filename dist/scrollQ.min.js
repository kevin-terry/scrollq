const t=new Map;let e="down",r=window.scrollY,s=!1;export const initScrollQ=(o={})=>{const n=o.threshold??.5,a=o.rootMargin??"0px 0px -10% 0px",i=o.reverse??!1,d=o.selector??"[data-q]";s||(window.addEventListener("scroll",()=>{const t=window.scrollY;e=t>r?"down":"up",r=t},{passive:!0}),s=!0),o.duration&&document.documentElement.style.setProperty("--q-duration",o.duration),o.easing&&document.documentElement.style.setProperty("--q-easing",o.easing),o.fromY&&document.documentElement.style.setProperty("--q-from-y",o.fromY),o.fromX&&document.documentElement.style.setProperty("--q-from-x",o.fromX),requestAnimationFrame(()=>{document.body.classList.add("q-ready")});const c=new Map;return document.querySelectorAll(d).forEach(r=>{const s=r.getAttribute("data-q")||"",o=r.getAttribute("data-q-threshold"),d=null!==o&&""!==o?Math.min(Math.max(parseFloat(o)||0,0),1):n,l=r.getAttribute("data-q-reverse"),u=r.hasAttribute("data-q-reverse")?"false"!==l:i;let m=a;const q=r.getAttribute("data-q-offset");if(q){m=`0px 0px ${q.match(/[a-z%]+$/i)?q:`${q}px`} 0px`}const y=r.getAttribute("data-q-from");y&&(s.includes("up")||s.includes("down")?r.style.setProperty("--q-from-y",y):(s.includes("left")||s.includes("right"))&&r.style.setProperty("--q-from-x",y));const p=r.getAttribute("data-q-duration"),b=r.getAttribute("data-q-easing"),g=r.getAttribute("data-q-delay");p&&r.style.setProperty("--q-duration",p),b&&r.style.setProperty("--q-easing",b),g&&r.style.setProperty("--q-delay",`${g}ms`);const f=((r,s,o)=>{const n=`${r}-${s}-${o}`;if(c.has(n))return c.get(n);const a=new IntersectionObserver(t=>{t.forEach(t=>{const s=t.target,n=s.classList.contains("q-active"),i=t.isIntersecting&&t.intersectionRatio>=r,d=!s.hasAttribute("data-q-observed");i&&!n?!d&&o&&"down"!==e||(s.classList.add("q-active"),s.setAttribute("data-q-observed","true"),o||a.unobserve(s)):!i&&n&&o&&"up"===e?s.classList.remove("q-active"):d&&(t.boundingClientRect.bottom<0&&s.classList.add("q-active"),s.setAttribute("data-q-observed","true"))})},{threshold:r,rootMargin:s});return c.set(n,a),t.set(n,a),a})(d,m,u);f.observe(r)}),()=>{c.forEach(t=>t.disconnect()),c.clear()}};export const destroyScrollQ=()=>{t.forEach(t=>t.disconnect()),t.clear()};